## 指令集

首先简单过一下x86下SIMD的指令集都提供了什么功能：

1. mmx:
   * 引入了8个64bits的寄存器，可以表示2个32位整数，4个16位整数或者8个8位整数
   * 仅提供整数的向量计算
   * 1997年提出，Intel奔腾2之后开始支持，AMD在K6后支持
2. SSE(SSE, SSE2, SSE3, SSE4):
   * 引入了16个128bits的寄存器（32位机器上只有8个），可以表示4个单精度浮点数（SSE1）；2个双精度浮点数，2个64位整数，4个32位整数，8个16位整数，16个8位整数（SSE2）。
   * 浮点和整数的向量运算都支持，
   * 1999年提出，Intel奔腾3之后开始支持，AMD在速龙XP后支持。SSE2在2001年提出，SSE2在01年，SSE3在04年，SSE4在06年。
3. AVX(AVX, AVX2, AVX512):
   * AVX引入了16个256bits的寄存器（32位机器上只有8个），AVX512则引入了32个512bits的寄存器和8个opmask寄存器。其中在AVX中，只能存浮点数，而在AVX2后则都支持整数。
   * 浮点和整数的向量运算都支持。而在AVX512还支持了mask运算，有了功能完整的permute操作blahblah。
   * AVX在08年提出（第一代酷睿开始支持），AVX2在13年提出（第四代酷睿开始），AVX512在16年提出（第六代酷睿~第十一代酷睿，十二代之后就不支持了。。。反倒zen4还支持）。



说实话，我觉得AVX512才是满血的AVX指令，但可惜十二代酷睿就不支持了。。。之前的permute操作只能以128bits为单位来做；没有mask_xx操作，没法很方便单独操作向量里的其中某部分；AVX512还支持神器compressstore/expendload操作，可以把向量“部分”写到内存里，或者是“部分”读到寄存器里，可以避免越界。

（另外之前AVX512指令带来的CPU降频的问题，在十代酷睿之后就解决了）